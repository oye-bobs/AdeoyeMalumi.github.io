<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>abd4acdfd5474c10b5b07dcfc2053359</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="f55e8ef8" class="cell markdown">
<p><b>Spectrogram Analysis of Earthquake and Non-Earthquake
Signals</b></p>
<p>In this notebook, we will explore how to create and analyze
spectrograms for various earthquake and non-earthquake signals. A
<strong>spectrogram</strong> is a visual representation of the spectrum
of frequencies in a signal as it varies over time. It is generated by
breaking down the signal into smaller time segments, applying a Fourier
Transform to each segment, and then plotting the resulting frequency
content over time.</p>
<p>Spectrograms are particularly useful in seismology because they allow
us to observe how the frequency content of seismic signals changes over
the course of an event, such as an earthquake. This can help us identify
different types of seismic waves, distinguish between earthquake and
non-earthquake signals (like explosions or ambient noise), and analyze
the energy distribution across different frequencies. By visualizing
these patterns, we gain deeper insights into the nature and dynamics of
seismic events.</p>
</div>
<div id="fad77689" class="cell code" data-execution_count="12">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> obspy.clients.fdsn <span class="im">import</span> Client</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> obspy <span class="im">import</span> UTCDateTime</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<div id="e9295eed" class="cell markdown">
<p><b>Comparison of Earthquake and Explosion with Similar Energy
Release</b></p>
<p>In this section, we will compare the spectrograms of two different
seismic events: an earthquake and an explosion. Both events have a
similar energy release, with a magnitude of approximately 3, and
originate from a similar location. By examining the IU.TUC.00.BHZ
recordings for these events, which are available from the IRIS data
center, we can observe how the frequency content of the signals differs
between an earthquake and an explosion. This comparison will help us
understand the distinct characteristics of seismic waves generated by
these two types of events.</p>
</div>
<div id="6e5b4a0f" class="cell code" data-execution_count="13">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(<span class="st">&quot;IRIS&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>station <span class="op">=</span> <span class="st">&quot;TUC&quot;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>channel <span class="op">=</span> <span class="st">&quot;BHZ&quot;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>network <span class="op">=</span> <span class="st">&quot;IU&quot;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>location <span class="op">=</span> <span class="st">&quot;00&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>startt <span class="op">=</span> UTCDateTime(<span class="st">&quot;2014-07-11T06:15:50&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>endt <span class="op">=</span> UTCDateTime(<span class="st">&quot;2014-07-11T06:17:50&quot;</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>st <span class="op">=</span> client.get_waveforms(network, station, location, channel, startt, endt)</span></code></pre></div>
</div>
<div id="d6bb313f" class="cell markdown">
<p><b>Extracting and Plotting the Seismic Trace</b></p>
<p>We will now extract the first <code>Trace</code> object from the
<code>Stream</code> we just downloaded. This <code>Trace</code>
represents a single component of the seismic data. After extracting the
trace, we will plot it to visualize the seismic signal.</p>
</div>
<div id="5e5592d4" class="cell code" data-execution_count="15">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> st[<span class="dv">0</span>]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> tr.plot()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/e32d6ade82c8f9b3892bf5532229a4ead6797d3a.png" /></p>
</div>
</div>
<div id="5a57e652" class="cell code" data-execution_count="16">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">&#39;figure.figsize&#39;</span>] <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">4</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> tr.spectrogram(per_lap<span class="op">=</span><span class="fl">.5</span>, wlen<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/99bf2766401abfd354d2e80a7f703dd851f75c4a.png" /></p>
</div>
</div>
<div id="5733ef63" class="cell markdown">
<p><b>Description of the Spectrogram</b></p>
<p>The spectrogram has a <strong>horizontal axis representing
time</strong> (from 0 to approximately 120 seconds) and a
<strong>vertical axis representing frequency</strong> (from 0 to 10 Hz).
The colors within the spectrogram indicate the intensity or amplitude of
various frequencies at different times.</p>
<ul>
<li><strong>Darker areas</strong> suggest lower amplitudes.</li>
<li><strong>Brighter colors</strong> like yellow and green signify
higher amplitudes.</li>
</ul>
<p><b>Patterns Observed</b></p>
<ul>
<li>There is a <strong>bright yellow vertical stripe</strong> around the
60-second mark, which fades into green on both sides.</li>
<li>This central bright area transitions to darker blues and purples,
indicating less intensity towards the edges.</li>
</ul>
<p><b>Important Points</b></p>
<ul>
<li>The bright yellow stripe suggests a significant event or spike in
frequency at that specific moment in time.</li>
<li>The intensity is highest around this central area and tapers off
towards the edges.</li>
<li>This pattern provides insight into how energy is distributed across
different frequencies over time within the signal.</li>
</ul>
</div>
<div id="b162b180" class="cell markdown">
<p><b>Requesting Seismogram for Explosion Event</b></p>
<p>Next, we will examine a seismogram from an explosion of similar size
at the same station. The time to request for this event is December 27,
1999, at 20:58:30, and you should request the same length of time as for
the earthquake.</p>
</div>
<div id="62ab05ad" class="cell code" data-execution_count="18">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>startt <span class="op">=</span> UTCDateTime(<span class="st">&quot;1999-12-27T20:58:30&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>endt <span class="op">=</span> UTCDateTime(<span class="st">&quot;1999-12-27T21:00:30&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>st <span class="op">=</span> client.get_waveforms(network, station, location, channel, startt, endt)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> st[<span class="dv">0</span>]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> tr.plot()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/eb6182087827e360837b93e690e17e66ce586881.png" /></p>
</div>
</div>
<div id="cba54101" class="cell markdown">
<p><b>Plotting the Spectrogram of the Explosion</b></p>
<p>To plot a spectrogram of the explosion with the same parameters as
for the earthquake, we use the <code>spectrogram</code> method from the
<code>Trace</code> object in ObsPy. The parameters used are:</p>
<ul>
<li><code>per_lap=0.5</code>: This sets the overlap between consecutive
windows to 50%.</li>
<li><code>wlen=2</code>: This sets the window length to 2 seconds.</li>
</ul>
</div>
<div id="2c3aacbe" class="cell code" data-execution_count="19">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a> fig <span class="op">=</span> tr.spectrogram(per_lap<span class="op">=</span><span class="fl">.5</span>, wlen<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/4fe5b39bf86b695e234f6b6f5a8817e713399c84.png" /></p>
</div>
</div>
<div id="1a738ab4" class="cell code" data-execution_count="20">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(<span class="st">&quot;IRIS&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>net <span class="op">=</span> <span class="st">&quot;XV&quot;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>sta <span class="op">=</span> <span class="st">&quot;B15A&quot;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>loc <span class="op">=</span> <span class="st">&quot;01&quot;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>cha <span class="op">=</span> <span class="st">&quot;HHZ&quot;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>endt <span class="op">=</span> UTCDateTime(<span class="st">&quot;2005-10-27T09:15:00&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>startt <span class="op">=</span> UTCDateTime(<span class="st">&quot;2005-10-27T08:15:00&quot;</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>st <span class="op">=</span> client.get_waveforms(net, sta, loc, cha, startt, endt)</span></code></pre></div>
</div>
<div id="f9a16d4a" class="cell code" data-execution_count="21">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> st[<span class="dv">0</span>]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> tr.plot()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/5d96c75ef150a254ae8e1ec8cb5edb9607ece46e.png" /></p>
</div>
</div>
<div id="d8ad4e42" class="cell code" data-execution_count="22">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> tr.spectrogram(per_lap<span class="op">=</span><span class="fl">0.5</span>, wlen<span class="op">=</span><span class="dv">25</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/0b8fd1877b1e83425430f0c52fd09964edf04f9f.png" /></p>
</div>
</div>
<div id="07e0c180" class="cell code" data-execution_count="23">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> tr.spectrogram(show<span class="op">=</span><span class="va">False</span>, per_lap<span class="op">=</span><span class="fl">.5</span>, wlen<span class="op">=</span><span class="dv">25</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.axes[<span class="dv">0</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> ax.images[<span class="dv">0</span>]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>im.set_clim(vmax<span class="op">=</span><span class="dv">800</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/83749829bebe996158ba8a09d0975bdf3be2b550.png" /></p>
</div>
</div>
<div id="eb9dae92" class="cell code" data-execution_count="24">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> tr.spectrogram(show<span class="op">=</span><span class="va">False</span>, per_lap<span class="op">=</span><span class="fl">.5</span>, wlen<span class="op">=</span><span class="dv">25</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.axes[<span class="dv">0</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="fl">0.5</span>, <span class="dv">8</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> ax.images[<span class="dv">0</span>]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>im.set_clim(vmax<span class="op">=</span><span class="dv">800</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/58c82c6ea7ada8e941f627356b115340897e05a8.png" /></p>
</div>
</div>
<div id="4ee95d67" class="cell code" data-execution_count="25">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(<span class="st">&quot;NCEDC&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>net <span class="op">=</span> <span class="st">&quot;BK&quot;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>sta <span class="op">=</span> <span class="st">&quot;PKD&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>loc <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>cha <span class="op">=</span> <span class="st">&quot;HHE&quot;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>startt <span class="op">=</span> UTCDateTime(<span class="st">&quot;2002-11-03T22:18&quot;</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>endt <span class="op">=</span> UTCDateTime(<span class="st">&quot;2002-11-03T22:41&quot;</span>)</span></code></pre></div>
</div>
<div id="ac30b243" class="cell code" data-execution_count="26">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>st <span class="op">=</span> client.get_waveforms(net, sta, loc, cha, startt, endt)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> st[<span class="dv">0</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> tr.plot()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/6eb70f19c218c7706954cea337444b9b185beb41.png" /></p>
</div>
</div>
<div id="6acb6ad5" class="cell code" data-execution_count="27">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> tr.spectrogram(per_lap<span class="op">=</span><span class="fl">.5</span>, wlen<span class="op">=</span><span class="dv">10</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/7427595ae5af502b98d6950c5016760c83400ce4.png" /></p>
</div>
</div>
<div id="322144c6" class="cell code" data-execution_count="28">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> tr.spectrogram(per_lap<span class="op">=</span><span class="fl">.5</span>, wlen<span class="op">=</span><span class="dv">10</span>, log<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/a61cf4252fc872799141618b713d4745a85d7d9d.png" /></p>
</div>
</div>
<div id="b51704d6" class="cell code" data-execution_count="29">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> tr.spectrogram(show<span class="op">=</span><span class="va">False</span>, per_lap<span class="op">=</span><span class="fl">.5</span>, wlen<span class="op">=</span><span class="dv">10</span>, log<span class="op">=</span><span class="va">True</span>, dbscale<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/84efebcd067860865b1f0ff0e72225ec98b8768f.png" /></p>
</div>
</div>
<div id="ac10eff1" class="cell code" data-execution_count="30">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> tr.spectrogram(show<span class="op">=</span><span class="va">False</span>, per_lap<span class="op">=</span><span class="fl">.5</span>, wlen<span class="op">=</span><span class="dv">10</span>, dbscale<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.axes[<span class="dv">0</span>]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="dv">20</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> ax.images[<span class="dv">0</span>]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(im.get_clim())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(-96.34717168809901, 134.0755363067488)
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/b48f3b9ef60b8e9f52c107db6bc5d0837ee23861.png" /></p>
</div>
</div>
<div id="aa9c471a" class="cell code" data-execution_count="31">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> tr.spectrogram(show<span class="op">=</span><span class="va">False</span>, per_lap<span class="op">=</span><span class="fl">.5</span>, wlen<span class="op">=</span><span class="dv">10</span>, dbscale<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;plasma&#39;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.axes[<span class="dv">0</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="dv">20</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> ax.images[<span class="dv">0</span>]</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>vmin <span class="op">=</span> <span class="fl">9.9244636932512</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>vmax <span class="op">=</span> <span class="fl">69.9244636932512</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>im.set_clim(vmin, vmax)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/1e945ba4f9a265ae0f7b599c2f762bb48486eaa0.png" /></p>
</div>
</div>
<div id="4f9fccf7" class="cell code" data-execution_count="32">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ftr <span class="op">=</span> tr.copy()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ftr.<span class="bu">filter</span>(<span class="bu">type</span><span class="op">=</span><span class="st">&#39;bandpass&#39;</span>, freqmin<span class="op">=</span><span class="fl">2.0</span>, freqmax<span class="op">=</span><span class="fl">20.0</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> ftr.plot()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9279d874b38f4eca876f07592f0e1bc4/48f7d286d4384d7db4630e78a3090bf0c0d47116.png" /></p>
</div>
</div>
<div id="fd798455" class="cell code">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
